<!DOCTYPE html>
<html>
<head>
    <title>Caller</title>
</head>
<body>
    <h2>Caller - WebRTC with Video</h2>
    <button onclick="startCall()">Start Call</button>
    <video id="localVideo" autoplay muted playsinline style="width: 240px; height: 180px;"></video>
    <video id="remoteVideo" autoplay playsinline style="width: 240px; height: 180px;"></video>

    <script>
        var peerConnection;
        var localStream;

        async function startCall() {
            console.log(1);
            peerConnection = new RTCPeerConnection();
            console.log(2);
            localStream = await navigator.mediaDevices.getUserMedia({ audio: true, video: true });
            localStream.getTracks().forEach(track => peerConnection.addTrack(track, localStream));
            console.log(3);

            document.getElementById('localVideo').srcObject = localStream;

            peerConnection.ontrack = event => {
                if (event.track.kind == "video") {
                    document.getElementById('remoteVideo').srcObject = event.streams[0];
                }
            };

            console.log(4);

            const offer = await peerConnection.createOffer();
            await peerConnection.setLocalDescription(offer);

            console.log(JSON.stringify(offer)); // For signaling in a real app
        }
    </script>
</body>
</html>
